#include <Arduino.h>

#define LED 2

void setup() {
  Serial.begin(115200);        // Monitor USB
  Serial.println("ESP32 listo (UART2)");

  pinMode(LED, OUTPUT);

  // UART2 en GPIO16 (RX) y GPIO17 (TX)
  Serial2.begin(9600, SERIAL_8N1, 16, 17); 
}

void loop() {

  // Si llega un byte desde la Nucleo
  if (Serial2.available()) {
    char c = Serial2.read();
    Serial.print("RX UART2: ");
    Serial.println(c);

    // LED indicador
    digitalWrite(LED, HIGH);
    delay(80);
    digitalWrite(LED, LOW);
  }

  // EnvÃ­a mensaje cada 1 segundo
  Serial2.println("ESP32 -> NUCLEO");
  delay(1000);
}
